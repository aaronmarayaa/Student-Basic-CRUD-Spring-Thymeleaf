<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/css/student_form.css}">
    <title>[[${pageTitle}]]</title>
</head>
  <body class="p-5">
    <main class="container-fluid text-center">
        <div><h2>[[${pageTitle}]]</h2></div>
        <form th:action="@{/student-management/student-save}" method="post" th:object="${student}"
          style="max-width: 550px;" class="mx-auto" 
        >
          <article class="border border-secondary rounded p-3 m-3">
            <input type="hidden" th:field="*{id}"/>

            <div class="form-group row">
              <label class="col-sm-4 col-form-label">First Name: </label>
              <div class="col-sm-8">
                <input type="text" th:field="*{firstName}" class="form-control" required minlength="2">
              </div>
            </div>

            <div class="form-group row mt-3">
              <label class="col-sm-4 col-form-label">Last Name: </label>
              <div class="col-sm-8">
                <input type="text" th:field="*{lastName}" class="form-control" required minlength="2">
              </div>
            </div>

            <div class="form-group row mt-3">
              <label class="col-sm-4 col-form-label">Age: </label>
              <div class="col-sm-8">
                  <input type="number" th:field="*{age}" class="form-control" required minlength="1">
              </div>
            </div>

            <div class="form-group row mt-5">
              <label class="col-sm-4 col-form-label">Email: </label>
              <div class="col-sm-8">
                  <input type="email" th:field="*{email}" class="form-control" required minlength="8">
              </div>
            </div>
            
            <div class="form-group row mt-3">
              <label class="col-sm-4 col-form-label">[[${passwordName}]] </label>
              <div class="col-sm-8">
                <div class="input-wrapper">
                    <input class="form-control passwordInput" type="password" id="newPassword" th:field="*{password}" name="newPassword" required minlength="8">

                    <a role="button" id="showPasswordBtn" onclick="togglePasswordVisibility()">
                        <img src="/images/eye-close.png" alt="Eye icon">
                    </a>
                </div>
              </div>
            </div>

            <div class="form-group row mt-3">
              <label class="col-sm-4 col-form-label">Confirm Password: </label>
              <div class="col-sm-8">
                <div class="input-wrapper">                
                  <input class="form-control passwordInput" type="password" id="confirmPassword" name="confirmPassword" required minlength="8">
                  <div id="errorMessage" class="errorMessage alert alert-danger text-center"></div>
                </div>
              </div>
            </div>

            <div>
              <button type="submit" class="btn btn-outline-info mt-4 m-3">Save</button>
              <button type="button" class="btn btn-outline-secondary mt-4 m-3" onclick="cancelForm()">Cancel</button>
            </div>
          </article>
        </form>
    </main>

    <script>
      function cancelForm() {
        window.location = "[[@{/student-management/home}]]"
      }

      function togglePasswordVisibility() {
        var passwordInputs = document.getElementsByClassName("passwordInput");
        var showPasswordBtn = document.getElementById("showPasswordBtn");

        for (var i = 0; i < passwordInputs.length; i++) {
          if (passwordInputs[i].type === "password") {
            passwordInputs[i].type = "text";
          } else {
            passwordInputs[i].type = "password";0
          }
        }

        var img = showPasswordBtn.querySelector('img');
        img.src = (passwordInputs[0].type === "password") ? "/images/eye-close.png" : "/images/eye-open.png";
      }

    </script>
  </body>
</html>